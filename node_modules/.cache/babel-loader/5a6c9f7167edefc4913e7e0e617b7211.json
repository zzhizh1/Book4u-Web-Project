{"ast":null,"code":"var _jsxFileName = \"/Users/kejingwang/Desktop/CIS550Database/AllProjects/Project550New/client/src/components/Subpage.js\";\nimport React from 'react';\nimport { withRouter } from \"react-router-dom\";\nimport '../style/Subpage.css';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport PageNavbar from './PageNavbar';\nimport StarIcon from \"../assets/images/star.png\";\nimport StarRatingComponent from \"react-star-rating-component\";\n\nclass Subpage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      username: window.localStorage.getItem(\"username\"),\n      ISBN: this.props.location.state.ISBN,\n      //ISBN: from the props.history.push in Dashboard/Rec code, the ISBN of book clicked\n      book: {},\n      //detailed book info: title, author, publisher, year, image_url_l\n      curRating: 0,\n      //current rating of the user for this ISBN\n      avgRating: 0 //average rating of this ISBN\n\n    };\n    const eventsArr = [//submit rating, button click\n    \"submitRating\"];\n    eventsArr.map(ev => {\n      this[ev] = this[ev].bind(this);\n      return \"\";\n    });\n  }\n\n  componentDidMount() {\n    console.log(\"current book's ISBN: \" + this.state.ISBN);\n    console.log(\"current username: \" + this.state.username); //GET BOOK BY ISBN\n\n    fetch(`http://localhost:8081/book/${this.state.ISBN}`, {\n      method: 'GET'\n    }).then(res => res.json()).then(resArray => {\n      if (!resArray) return;\n      this.setState({\n        book: resArray[0]\n      });\n    }).catch(err => console.log(err)); // Print the error if there is one. \n    //GET RATING BY ISBN\n\n    fetch(`http://localhost:8081/avgRating/${this.state.ISBN}`, {\n      method: 'GET'\n    }).then(res => res.json()).then(resArray => {\n      if (!resArray) return;\n      console.log(resArray);\n      this.setState({\n        avgRating: resArray[0].avgRating\n      });\n    }).catch(err => console.log(err)); // Print the error if there is one.\n\n    console.log(this.state.avgRating);\n  } // Send an HTTP request to the server.\n  // fetch(\"http://localhost:8081/genres\", {\n  //   method: 'GET' // The type of HTTP request.\n  // })\n  //   .then(res => res.json()) // Convert the response data to a JSON.\n  //   .then(genreList => {\n  //     if (!genreList) return;\n  //     // Map each genreObj in genreList to an HTML element:\n  //     // A button which triggers the showMovies function for each genre.\n  //     let genreDivs = genreList.map((genreObj, i) =>\n  //       <GenreButton id={\"button-\" + genreObj.genre} onClick={() => this.showMovies(genreObj.genre)} genre={genreObj.genre} />\n  //     );\n  //     // Set the state of the genres list to the value returned by the HTTP response from the server.\n  //     this.setState({\n  //       genres: genreDivs\n  //     })\n  //   })\n  //   .catch(err => console.log(err))\t// Print the error if there is one.\n\n\n  onStarClick(nextValue, prevValue, name) {\n    this.setState({\n      curRating: nextValue\n    });\n  }\n\n  sumbitRating() {\n    if (!this.state.username) {\n      alert(\"Please log in first!\");\n    } else if (!this.state.ISBN) {\n      alert(\"Error\");\n    } else if (this.state.curRating == 0) {\n      alert(\"Please select a number!\");\n    }\n\n    fetch(`http://localhost:8081/submitRating?username=${this.state.username}&ISBN=${this.state.ISBN}&rating=${this.state.curRating}`, {\n      method: 'GET' // The type of HTTP request.\n\n    }).then(res => res.json()) // Convert the response data to a JSON.\n    .then(resArray => {\n      if (resArray[0] == \"success\") {\n        alert(\"Rating submitted\");\n      } else {\n        alert(\"!!!!!\");\n      }\n    }).catch(err => console.log(err)); // Print the error if there is one.\n  }\n\n  render() {\n    //const {curRating} = this.state;  \n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"Subpage\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(PageNavbar, {\n      active: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container movies-container mt-5\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"list-wrap\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"list pr-1\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"list-box bg-white px-3 pt-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"h5\", {\n      className: \"list-title mb-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 17\n      }\n    }, \"\\u2261 Book Information\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"list-row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      className: \"img-fluid\",\n      src: this.state.book.image_url_l,\n      alt: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 15\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      className: \"my-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 15\n      }\n    }, this.state.book.title), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row ratingRow1\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 17\n      }\n    }, \"Average rating: \"), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 17\n      }\n    }, this.state.avgRating.toFixed(1))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row ratingRow2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 17\n      }\n    }, \"Your rating: \"), /*#__PURE__*/React.createElement(StarRatingComponent, {\n      name: \"rate2\",\n      editing: true,\n      starCount: 10,\n      value: this.state.curRating,\n      onStarClick: this.onStarClick.bind(this),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 17\n      }\n    }, this.state.curRating)), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-outline-secondary bg-primary text-white\",\n      type: \"button\",\n      id: \"button-rating\",\n      onClick: this.sumbitRating,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 15\n      }\n    }, \"Submit Your Rating\"), /*#__PURE__*/React.createElement(\"ul\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 17\n      }\n    }, \"ISBN: \", this.state.ISBN), /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 17\n      }\n    }, \"Author: \", this.state.book.author), /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 17\n      }\n    }, \"Publisher: \", this.state.book.publisher), /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 17\n      }\n    }, \"Year: \", this.state.book.year)), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-outline-secondary bg-primary text-white\",\n      type: \"button\",\n      id: \"button-markBook\",\n      onClick: this.addToBookshelf,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 15\n      }\n    }, \"Like it? Add to bookshelf\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"h3\", {\n      className: \"my-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 11\n      }\n    }, \"Related Books\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"list-row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-3 col-sm-6 mb-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      href: \"#\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      className: \"img-fluid\",\n      src: \"http://placehold.it/500x300\",\n      alt: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 21\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-3 col-sm-6 mb-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      href: \"#\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      className: \"img-fluid\",\n      src: \"http://placehold.it/500x300\",\n      alt: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 21\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-3 col-sm-6 mb-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      href: \"#\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      className: \"img-fluid\",\n      src: \"http://placehold.it/500x300\",\n      alt: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 21\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-3 col-sm-6 mb-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      href: \"#\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      className: \"img-fluid\",\n      src: \"http://placehold.it/500x300\",\n      alt: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 21\n      }\n    })))))))));\n  }\n\n}\n\nexport default withRouter(Subpage);","map":{"version":3,"sources":["/Users/kejingwang/Desktop/CIS550Database/AllProjects/Project550New/client/src/components/Subpage.js"],"names":["React","withRouter","PageNavbar","StarIcon","StarRatingComponent","Subpage","Component","constructor","props","state","username","window","localStorage","getItem","ISBN","location","book","curRating","avgRating","eventsArr","map","ev","bind","componentDidMount","console","log","fetch","method","then","res","json","resArray","setState","catch","err","onStarClick","nextValue","prevValue","name","sumbitRating","alert","render","image_url_l","title","toFixed","author","publisher","year","addToBookshelf"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { withRouter } from \"react-router-dom\";\nimport '../style/Subpage.css';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport PageNavbar from './PageNavbar';\nimport StarIcon from \"../assets/images/star.png\";\nimport StarRatingComponent from \"react-star-rating-component\";\n\nclass Subpage extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      username: window.localStorage.getItem(\"username\"),\n      ISBN: this.props.location.state.ISBN,  //ISBN: from the props.history.push in Dashboard/Rec code, the ISBN of book clicked\n      book: {}, //detailed book info: title, author, publisher, year, image_url_l\n      curRating: 0, //current rating of the user for this ISBN\n      avgRating: 0 //average rating of this ISBN\n    }\n\n    const eventsArr = [\n      //submit rating, button click\n      \"submitRating\"\n    ];\n    eventsArr.map((ev) => {\n      this[ev] = this[ev].bind(this);\n      return \"\";\n    });\n  }\n\n  componentDidMount() {\n    console.log(\"current book's ISBN: \" + this.state.ISBN);\n    console.log(\"current username: \" + this.state.username);\n\n    //GET BOOK BY ISBN\n    fetch(`http://localhost:8081/book/${this.state.ISBN}`, {\n      method: 'GET' \n    })\n      .then(res => res.json())\n      .then(resArray => {\n        if (!resArray) return;\n\n        this.setState({\n          book: resArray[0]\n        });\n      })\n      .catch(err => console.log(err))\t// Print the error if there is one. \n\n    //GET RATING BY ISBN\n    fetch(`http://localhost:8081/avgRating/${this.state.ISBN}`, {\n      method: 'GET' \n    })\n      .then(res => res.json())\n      .then(resArray => {\n        if (!resArray) return;\n        console.log(resArray);\n        this.setState({\n          avgRating: resArray[0].avgRating\n        });\n      })\n      .catch(err => console.log(err))\t// Print the error if there is one.\n      console.log(this.state.avgRating);\n  } \n\n    // Send an HTTP request to the server.\n    // fetch(\"http://localhost:8081/genres\", {\n    //   method: 'GET' // The type of HTTP request.\n    // })\n    //   .then(res => res.json()) // Convert the response data to a JSON.\n    //   .then(genreList => {\n    //     if (!genreList) return;\n    //     // Map each genreObj in genreList to an HTML element:\n    //     // A button which triggers the showMovies function for each genre.\n    //     let genreDivs = genreList.map((genreObj, i) =>\n    //       <GenreButton id={\"button-\" + genreObj.genre} onClick={() => this.showMovies(genreObj.genre)} genre={genreObj.genre} />\n    //     );\n\n    //     // Set the state of the genres list to the value returned by the HTTP response from the server.\n    //     this.setState({\n    //       genres: genreDivs\n    //     })\n    //   })\n    //   .catch(err => console.log(err))\t// Print the error if there is one.\n\n\n  onStarClick(nextValue, prevValue, name) {\n    this.setState({curRating: nextValue});\n  }\n\n  sumbitRating() {\n    if (!this.state.username) {\n      alert(\"Please log in first!\");\n    } else if (!this.state.ISBN) {\n      alert(\"Error\");\n    } else if (this.state.curRating == 0) {\n      alert(\"Please select a number!\")\n    }\n\n    fetch(`http://localhost:8081/submitRating?username=${this.state.username}&ISBN=${this.state.ISBN}&rating=${this.state.curRating}`, {\n      method: 'GET' // The type of HTTP request.\n    })\n      .then(res => res.json()) // Convert the response data to a JSON.\n      .then(resArray => {\n        if (resArray[0] == \"success\") {\n          alert(\"Rating submitted\");\n        } else {\n          alert(\"!!!!!\")\n        }\n      })\n      .catch(err => console.log(err))\t// Print the error if there is one.\n  }\n\n  render() {  \n    //const {curRating} = this.state;  \n\n    return (\n        <div className=\"Subpage\">\n        <PageNavbar active=\"\" />\n        <br/>\n        \n        <br></br>\n        <div className=\"container movies-container mt-5\">\n        {/* <!-- Page Content --> */}\n          <div className=\"list-wrap\">\n            <div className=\"list pr-1\">\n              <div className=\"list-box bg-white px-3 pt-3\">\n                <h5 className=\"list-title mb-3\">≡ Book Information</h5>\n        {/* <div className=\"jumbotron bg-white\"> */}\n\n          {/* <!-- Portfolio Item Heading --> */}\n          {/* <!-- Portfolio Item Row --> */}\n          <div className=\"list-row\" >\n        \n            <div className=\"col\">\n              <img className=\"img-fluid\" src={this.state.book.image_url_l} alt=\"\"/>\n            </div>\n        \n            <div className=\"col\">\n              <h3 className=\"my-4\">{this.state.book.title}</h3>\n              <div className=\"row ratingRow1\">\n                {/* <img id=\"starIcon\" src={StarIcon}/>\n                <h6>rating</h6> */}\n                <p>Average rating: </p>\n                <p>{this.state.avgRating.toFixed(1)}</p>\n              </div>\n              <div className=\"row ratingRow2\">\n                <p>Your rating: </p>\n                <StarRatingComponent \n                          name=\"rate2\"\n                          editing={true}\n                          starCount={10}\n                          value={this.state.curRating}\n                          onStarClick={this.onStarClick.bind(this)}\n                />\n                <p>{this.state.curRating}</p>\n              </div>\n              <button\n                  className=\"btn btn-outline-secondary bg-primary text-white\"\n                  type=\"button\"\n                  id=\"button-rating\"\n                  onClick={this.sumbitRating}>\n                  Submit Your Rating\n              </button>\n              {/* <h3 className=\"my-3\">Book Description</h3> */}\n              <ul>\n                <li>ISBN: {this.state.ISBN}</li>\n                <li>Author: {this.state.book.author}</li>\n                <li>Publisher: {this.state.book.publisher}</li>\n                <li>Year: {this.state.book.year}</li>\n              </ul>\n              <button\n                  className=\"btn btn-outline-secondary bg-primary text-white\"\n                  type=\"button\"\n                  id=\"button-markBook\"\n                  onClick={this.addToBookshelf}>\n                  Like it? Add to bookshelf\n              </button>\n            </div>\n          \n            <div className=\"row\"> \n\n            </div>\n        \n          </div>\n          {/* <!-- /.row --> */}  \n\n\n          <h3 className=\"my-4\">Related Books</h3>\n          {/* <!-- Related Projects Row --> */}        \n          <div className=\"list-row\">\n            \n            <div className=\"col-md-3 col-sm-6 mb-4\">\n              <a href=\"#\">\n                    <img className=\"img-fluid\" src=\"http://placehold.it/500x300\" alt=\"\"/>\n                </a>\n            </div>\n        \n            <div className=\"col-md-3 col-sm-6 mb-4\">\n              <a href=\"#\">\n                    <img className=\"img-fluid\" src=\"http://placehold.it/500x300\" alt=\"\"/>\n                  </a>\n            </div>\n        \n            <div className=\"col-md-3 col-sm-6 mb-4\">\n              <a href=\"#\">\n                    <img className=\"img-fluid\" src=\"http://placehold.it/500x300\" alt=\"\" />\n                  </a>\n            </div>\n        \n            <div className=\"col-md-3 col-sm-6 mb-4\">\n              <a href=\"#\">\n                    <img className=\"img-fluid\" src=\"http://placehold.it/500x300\" alt=\"\" />\n                  </a>\n            </div>\n        \n          </div>\n          {/* <!-- /.row --> */}\n        \n\n        {/* </div> */}\n          {/* <!-- /.jumbotron --> */}\n        </div>\n        {/* <!-- /.subpage --> */}\n\n        </div>\n        </div>\n        </div>\n        </div>\n    );\n  }\n}\nexport default withRouter(Subpage);\n"]},"metadata":{},"sourceType":"module"}